<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="theme-color" content="#e11d48">
  <title>BlockHunt • Challenges</title>

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <link href="../styles.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../favicon.png">
</head>
<body>

  <!-- Desktop Navbar -->
  <nav class="navbar navbar-expand-lg">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center gap-2" href="home.html">
        <i class="bi bi-qr-code-scan"></i> BlockHunt
      </a>
    </div>
  </nav>

  <!-- Mobile AppBar -->
  <div class="appbar py-2">
    <div class="container d-flex align-items-center justify-content-between">
      <div class="brand">BlockHunt</div>
    </div>
  </div>

  <main class="container py-4">
    <!-- Page head -->
    <div class="d-flex align-items-center justify-content-between mb-3">
      <div>
        <div class="small text-uppercase text-muted fw-bold">Now</div>
        <h1 class="h5 mb-0">Programming Challenges</h1>
      </div>
      <a class="btn btn-ghost" href="studio.html"><i class="bi bi-code-slash me-1"></i>Go to Studio</a>
    </div>

    <!-- Filters / Search -->
    <div class="panel p-3 mb-3">
      <div class="toolbar d-flex flex-wrap align-items-center gap-2">
        <div class="btn-group" role="group" aria-label="Difficulty">
          <button class="btn btn-ghost active" data-diff="all" id="dAll">All</button>
          <button class="btn btn-ghost" data-diff="easy" id="dEasy">Easy</button>
          <button class="btn btn-ghost" data-diff="medium" id="dMedium">Medium</button>
          <button class="btn btn-ghost" data-diff="hard" id="dHard">Hard</button>
        </div>

        <div class="ms-auto d-flex align-items-center gap-2 flex-wrap" id="tagsBar">
          <span class="chip" data-tag="math"><i class="bi bi-hash"></i> math</span>
          <span class="chip" data-tag="strings"><i class="bi bi-hash"></i> strings</span>
          <span class="chip" data-tag="lists"><i class="bi bi-hash"></i> lists</span>
          <span class="chip" data-tag="loops"><i class="bi bi-hash"></i> loops</span>
        </div>

        <div class="ms-auto" style="min-width:260px">
          <input type="search" class="form-control" id="searchBox" placeholder="Search questions…">
        </div>
      </div>
    </div>

    <!-- List -->
    <div class="row g-3" id="qList"><!-- JS injects cards --></div>

    <div class="mt-4 small muted">
      Tip:
    </div>
  </main>
    <button class="fab d-inline-flex align-items-center" id="fabScan">
    <i class="bi bi-qr-code-scan"></i> Scan
  </button>
<a href="admin.html"><button class="fab fab--secondary fab-admin fab--sm" id="fabAdmin" aria-label="Open Admin">
  <i class="bi bi-shield-lock"></i><span class="fab-label">Admin</span>
</button></a>
  <!-- Bottom Tab Bar -->
  <nav class="tabbar d-flex align-items-center gap-2">
    <a class="tab" href="home.html"><i class="bi bi-house"></i><span class="label">Home</span></a>
    <a class="tab active" href="#"><i class="bi bi-list-task"></i><span class="label">Challenges</span></a>
    <a class="tab" href="studio.html"><i class="bi bi-code-slash"></i><span class="label">Studio</span></a>
    <a class="tab" href="profile.html"><i class="bi bi-person"></i><span class="label">Profile</span></a>
  </nav>

  <script>
    // ===== Front-end only =====
    const Q_KEY = 'BlockHunt_current_question';

    const QUESTIONS = [
      {
        id: 'sum-1-to-n',
        title: 'Sum from 1 to n',
        difficulty: 'easy',
        tags: ['math','loops'],
        body: `Write a program that reads an integer <em>n</em> and prints the sum 1+2+...+n.
If <em>n</em> is negative, print <code>0</code>. Example: input <code>5</code> → output <code>15</code>.`
      },
      {
        id: 'reverse-string',
        title: 'Reverse a String',
        difficulty: 'easy',
        tags: ['strings'],
        body: `Read a line of text and print it reversed. Example: <code>hello</code> → <code>olleh</code>.`
      },
      {
        id: 'count-vowels',
        title: 'Count Vowels',
        difficulty: 'medium',
        tags: ['strings'],
        body: `Read a string and print the number of vowels (a,e,i,o,u). Case-insensitive.`
      },
      {
        id: 'max-in-list',
        title: 'Maximum in List',
        difficulty: 'medium',
        tags: ['lists','loops'],
        body: `Read an integer <em>n</em>, then read <em>n</em> integers. Print the maximum value.`
      },
      {
        id: 'prime-check',
        title: 'Prime Check',
        difficulty: 'hard',
        tags: ['math','loops'],
        body: `Read an integer and print <code>YES</code> if it is prime, otherwise <code>NO</code>.`
      }
    ];

    const DIFF_BADGES = {
      easy:   'bg-success-subtle text-success-emphasis',
      medium: 'bg-warning-subtle text-warning-emphasis',
      hard:   'bg-danger-subtle text-danger-emphasis'
    };

    // State & elements
    let diffFilter = 'all';
    let tagFilter = null;
    const searchBox = document.getElementById('searchBox');
    const qList = document.getElementById('qList');

    function matchesDiff(q){ return diffFilter === 'all' || q.difficulty === diffFilter; }
    function matchesTag(q){  return !tagFilter || q.tags.includes(tagFilter); }
    function matchesSearch(q){
      const qstr = (searchBox.value || '').toLowerCase().trim();
      if (!qstr) return true;
      return (
        q.title.toLowerCase().includes(qstr) ||
        q.body.toLowerCase().includes(qstr) ||
        q.tags.join(' ').toLowerCase().includes(qstr)
      );
    }

    function cardTemplate(q){
      const badgeCls = DIFF_BADGES[q.difficulty] || 'bg-secondary-subtle text-secondary-emphasis';
      return `
      <div class="col-12">
        <div class="q-card diff-${q.difficulty}">
          <div class="flex-grow-1">
            <div class="d-flex align-items-center justify-content-between gap-2">
              <div class="q-title">${q.title}</div>
              <span class="badge ${badgeCls} text-uppercase">${q.difficulty}</span>
            </div>
            <div class="q-body mt-1">${q.body}</div>
            <div class="q-meta mt-2 d-flex align-items-center gap-2 flex-wrap">
              ${q.tags.map(t=>`<span class="chip" data-tag="${t}"><i class="bi bi-hash"></i> ${t}</span>`).join('')}
            </div>
          </div>
          <div class="q-actions">
            <button class="btn btn-brand" data-solve="${q.id}">
              <i class="bi bi-play-fill me-1"></i>Solve in Studio
            </button>
          </div>
        </div>
      </div>`;
    }

    function render(){
      const items = QUESTIONS.filter(q => matchesDiff(q) && matchesTag(q) && matchesSearch(q));
      qList.innerHTML = items.length
        ? items.map(cardTemplate).join('')
        : `<div class="col-12"><div class="panel p-4 text-center">
             <div class="mb-2"><i class="bi bi-search" style="font-size:1.5rem"></i></div>
             <div class="fw-bold">No questions match your filters.</div>
             <div class="muted">Try changing difficulty / tag or search terms.</div>
           </div></div>`;

      // Wire up Solve
      qList.querySelectorAll('[data-solve]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const qid = btn.getAttribute('data-solve');
          const q = QUESTIONS.find(x=>x.id===qid);
          if (!q) return;
          localStorage.setItem(Q_KEY, JSON.stringify(q));
          window.location.href = 'studio.html';
        });
      });

      // Make tag chips clickable inside cards too
      qList.querySelectorAll('.q-meta .chip').forEach(chip=>{
        chip.addEventListener('click', ()=>{
          setTagFilter(chip.getAttribute('data-tag'));
        });
      });
    }

    // Difficulty filter buttons
    function setDiff(btn, mode){
      diffFilter = mode;
      document.querySelectorAll('[data-diff]').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      render();
    }
    document.getElementById('dAll').addEventListener('click', function(){ setDiff(this, 'all'); });
    document.getElementById('dEasy').addEventListener('click', function(){ setDiff(this, 'easy'); });
    document.getElementById('dMedium').addEventListener('click', function(){ setDiff(this, 'medium'); });
    document.getElementById('dHard').addEventListener('click', function(){ setDiff(this, 'hard'); });

    // Tag filter (top chips)
    function setTagFilter(tag){
      tagFilter = (tagFilter===tag) ? null : tag; // toggle
      document.querySelectorAll('#tagsBar .chip').forEach(c=>{
        c.classList.toggle('active', c.getAttribute('data-tag')===tagFilter);
      });
      render();
    }
    document.querySelectorAll('#tagsBar .chip').forEach(chip=>{
      chip.addEventListener('click', ()=> setTagFilter(chip.getAttribute('data-tag')) );
    });

    // Search
    searchBox.addEventListener('input', render);

    // Boot
    render();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
